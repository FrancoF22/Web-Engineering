<!-- collegare eventi (info.html) nell href -->
<style>
    /* stile del calendario e eventi*/
    .calendar-and-events-container {
        display: flex; /* Utilizza il flexbox per allineare gli elementi */
        align-items: flex-start; /* Allinea gli elementi in alto */
    }
    /* stile del container degli eventi */
    .events-container {
        width: 250px; /* Imposta la larghezza desiderata per il container degli eventi */
        border: 1px solid #ccc;
        padding: 10px;
        margin-right: 20px; /* Aggiunge uno spazio a destra per separare il container degli eventi dal calendario */
    }

    .events-container h2 {
        font-size: 18px;
        margin-bottom: 10px;
    }

    .events-container ul {
        list-style: none;
        padding: 0;
    }

    .events-container li {
        margin-bottom: 5px;
    }

    /* layout del calendario */
    #calendar {
        width: 300px;
        border: 1px solid #ccc;
        margin: 0 auto;
    }

    .header {
        display: flex;
        justify-content: space-between;
        background-color: #f0f0f0;
        padding: 10px;
    }

    .days {
        display: grid;
        grid-template-columns: repeat(7, 1fr);
        gap: 5px;
        padding: 10px;
    }

    .day {
        cursor: pointer;
        padding: 5px;
        border: 1px solid #ccc;
        background-color: #f0f0f0;
        text-align: center;
        user-select: none; /* Per evitare la selezione accidentale del testo */
    }

    .current-day {
        background-color: #ffff99;
        font-weight: bold;
    }

    /* stile del pulsante Data Corrente */
    #currentDateButton {
        background-color: #007bff; /* Cambia il colore di sfondo */
        color: #fff; /* Cambia il colore del testo */
        border: none;
        padding: 5px 10px;
        cursor: pointer;
    }

    #currentDateButton:hover {
        background-color: #0056b3; /* Cambia il colore di sfondo al passaggio del mouse */
    }

    /* stile tabella */
    .custom-table {
        border-collapse: collapse; /* Combina i bordi delle celle adiacenti */
        width: 100%; /* Imposta la larghezza della tabella al 100% del contenitore */
    }

    .custom-table th,
    .custom-table td {
        border: 1px solid #ddd; /* Aggiungi un bordo di 1px a tutte le celle */
        padding: 8px; /* Aggiungi spaziatura interna alle celle */
        text-align: left; /* Allinea il testo a sinistra nelle celle */
    }

    .custom-table th {
        background-color: #f2f2f2; /* Sfondo grigio per le intestazioni */
        font-weight: bold; /* Testo in grassetto per le intestazioni */
    }
</style>

<div class="home-container">

    <div class="calendar-and-events-container">
        <div class="events-container">
            <!-- Inserisci qui la visualizzazione degli eventi del giorno -->
            <h2>Eventi di Oggi</h2>
            <ul id="eventList">
                <!-- Gli eventi verranno visualizzati qui -->
            </ul>
            <div id="eventDetails">
                <!-- Dettagli degli eventi verranno visualizzati qui -->
            </div>
        </div>

        <div id="calendar">
            <button id="currentDateButton">Data Corrente</button>
            <div class="header">
                <button id="prevMonth">&lt;</button>
                <h1 id="currentMonth"></h1>
                <button id="nextMonth">&gt;</button>
            </div>
            <div class="days">
                <!-- Inserire qui i giorni del mese -->
            </div>
        </div>
    </div>

    <div class="home-home">
        <div class="lower">
            <table class="custom-table">
                <thead>
                    <tr>
                        <th>Nome</th>
                        <th>Luogo</th>
                        <th>Edificio</th>
                        <th>Piano</th>
                        <th>Capienza</th>
                        <th>Numero di prese elettriche</th>
                        <th>Numero di prese di rete</th>
                        <th>Responsabile</th>
                        <th>Attrezzature</th>
                        <th>Azione</th>
                    </tr>
                </thead>
                <tbody>
                    <#if (ListaAule?size>0)>
                    <#list ListaAule as aula>
                    <tr>
                        <td>${aula.nome}</td>
                        <td>${aula.luogo}</td>
                        <td>${aula.edificio}</td>
                        <td>${aula.piano}</td>
                        <td>${aula.capienza}</td>
                        <td>${aula.preseElettriche}</td>
                        <td>${aula.preseRete}</td>
                        <td><#if aula.professore??>${aula.professore.nome} ${aula.professore.cognome}</#if></td>
                        <td>
                            <#list aula.attrezzature as att>
                            ${att},
                            </#list>
                        </td>
                        <!-- <td><a href="eventi?id=${aula.key}">[visualizza eventi]</a></td> -->
                        <td><a href="eventi?id=${aula.key}"><button class="Bottone-tabela">Eventi Aula</button></a></td>
                    </tr>
                    </#list>
                    </#if>
                </tbody>            
            </table>
        </div>
    </div>

</div>

<script>
    document.addEventListener('DOMContentLoaded', function () {
        const prevMonthButton = document.getElementById('prevMonth');
        const nextMonthButton = document.getElementById('nextMonth');
        const currentMonthElement = document.getElementById('currentMonth');
        const daysContainer = document.querySelector('.days');
        const currentDateButton = document.getElementById('currentDateButton'); // Seleziona il pulsante "Data Corrente"
        const eventList = document.getElementById('eventList');
        const eventDetails = document.getElementById('eventDetails'); // Nuovo elemento per i dettagli degli eventi

        // Ottieni l'anno corrente dalla data locale
        const currentYear = new Date().getFullYear();

        let currentDate = new Date();

        function renderCalendar() {
            const year = currentYear; // Utilizza l'anno corrente
            const month = currentDate.getMonth();
            const options = {year: 'numeric', month: 'long'};
            currentMonthElement.textContent = currentDate.toLocaleDateString('it-IT', options);
            // Pulisci il container dei giorni
            daysContainer.innerHTML = '';
            const today = new Date(); // Ottieni la data odierna
            const daysInMonth = new Date(year, month + 1, 0).getDate();
            // Aggiungi i giorni del mese
            for (let day = 1; day <= daysInMonth; day++) {
                const dayElement = document.createElement('div');
                dayElement.textContent = day;
                dayElement.classList.add('day'); // Aggiungi la classe "day" per identificare i giorni

                // Aggiungi la classe "current-day" se il giorno Ã¨ uguale a oggi
                if (year === today.getFullYear() && month === today.getMonth() && day === today.getDate()) {
                    dayElement.classList.add('current-day');
                }

                daysContainer.appendChild(dayElement);
            }
        }

        renderCalendar();
        prevMonthButton.addEventListener('click', function () {
            currentDate.setMonth(currentDate.getMonth() - 1);
            renderCalendar();
        });
        nextMonthButton.addEventListener('click', function () {
            currentDate.setMonth(currentDate.getMonth() + 1);
            renderCalendar();
        });
        currentDateButton.addEventListener('click', function () {
            currentDate = new Date(); // Reimposta la data corrente
            renderCalendar();
        });

        // Aggiungi un listener per il click sui giorni del calendario
        daysContainer.addEventListener('click', function (event) {
            const clickedDayElement = event.target;
            if (clickedDayElement.classList.contains('day')) {
                const selectedDate = new Date(currentDate);
                selectedDate.setDate(parseInt(clickedDayElement.textContent)); // Imposta il giorno selezionato

                // Visualizza gli eventi per la data selezionata
                renderEventsForDay(selectedDate);
            }
        });

        function renderEventsForDay(selectedDate) {
            // Simula il recupero degli eventi dal backend o da un'altra fonte dati
            const events = getEventsForDate(selectedDate);

            // Aggiungi questo console.log per verificare i dati degli eventi
            console.log('Eventi per la data selezionata:', events);

            // Visualizza gli eventi nell'elenco degli eventi
            eventList.innerHTML = '';
            if (events.length > 0) {
                events.forEach(event => {
                    const listItem = document.createElement('li');
                    listItem.textContent = event;
                    eventList.appendChild(listItem);
                });
            } else {
                const noEventItem = document.createElement('li');
                noEventItem.textContent = 'Nessun evento per questo giorno.';
                eventList.appendChild(noEventItem);
            }

            // Visualizza i dettagli degli eventi nell'area degli eventDetails
            eventDetails.innerHTML = '';
            if (events.length > 0) {
                events.forEach(event => {
                    const eventDetail = document.createElement('div');
                    eventDetail.textContent = event;
                    eventDetails.appendChild(eventDetail);
                });
            } else {
                const noEventDetail = document.createElement('div');
                noEventDetail.textContent = 'Nessun evento per questo giorno.';
                eventDetails.appendChild(noEventDetail);
            }
        }

        // Funzione di esempio per ottenere gli eventi per una data specifica
        function getEventsForDate(date) {
            // Simula il recupero degli eventi dal backend o da un database
            const events = {
                '2023-10-30': ['Evento 1', 'Evento 2'],
                '2023-10-31': ['Evento 3'],
                // Aggiungi altri dati sugli eventi qui
            };
            const formattedDate = formatDate(date);
            return events[formattedDate] || [];
        }

        function formatDate(date) {
            const formattedDate = date.toLocaleDateString('it-IT', {year: 'numeric', month: 'long', day: 'numeric'});
            return formattedDate;
        }
    });
</script>
